/*! weixin-ui 2015-06-12 */
/* author:zhanwangye */
dist/define("zui/dialog",["zui/dialog/overlay","zui/dialog/mask","zui/dialog/dialog"],function(a){var b=$.extend({LoadMask:a("zui/dialog/mask"),Overlay:a("zui/dialog/overlay"),Dialog:a("zui/dialog/dialog").Dialog,Alert:a("zui/dialog/dialog").Alert,Confirm:a("zui/dialog/dialog").Confirm,Flash:a("zui/dialog/dialog").Flash,Loading:a("zui/dialog/dialog").Loading});return b}),define("zui/dialog/overlay",function(){function a(a){this._options=$.extend(this._options,a),this._init()}var b={close:'<a class="ui-dialog-close" title="关闭"><span class="ui-icon ui-icon-delete">×</span></a>',mask:'<div class="ui-mask"></div>',title:'<div class="ui-dialog-title"><h3><%=title%></h3></div>',wrap:'<div class="ui-dialog"><div class="ui-dialog-content"></div><% if(btns){ %><div class="ui-dialog-btns"><% for(var i=0, length=btns.length; i<length; i++){var item = btns[i]; %><a class="ui-btn ui-btn-<%=item.index%>" data-key="<%=item.key%>"><%=item.text%></a><% } %></div><% } %></div> '};return a.prototype={_options:{autoOpen:!0,buttons:null,closeBtn:!0,mask:!0,width:270,height:"auto",title:null,content:null,scrollMove:!0,container:null,maskClick:null,animate:null,position:null},getWrap:function(){return this._options._wrap},_init:function(){var a,c=this,d=c._options,e=0,f=$.proxy(c._eventHandler,c),g={};d._container=$(d.container||document.body),(d._cIsBody=d._container.is("body"))||d._container.addClass("ui-dialog-container"),g.btns=a=[],d.buttons&&$.each(d.buttons,function(b){a.push({index:++e,text:b,key:b})}),d._mask=d.mask?$(b.mask).appendTo(d._container):null,d._wrap=$(zUtil.parseTpl(b.wrap,g)).appendTo(d._container),d._content=$(".ui-dialog-content",d._wrap),d._title=$(b.title),d._close=d.closeBtn?$(b.close):!1,c.$el=c.$el||d._content,c.title(d.title),c.content(d.content),d._wrap.css({width:d.width,height:d.height}),$(window).on("ortchange",f),d._wrap.on("click",f),d._mask&&d._mask.on("click",f),d.autoOpen&&c.open()},_create:function(){var a=this._options;this._options.setup&&(a.content=a.content||this.$el.show(),a.title=a.title||this.$el.attr("title"))},_eventHandler:function(a){var b,c,d,e=this,f=e._options;switch(a.type){case"ortchange":this.refresh();break;case"touchmove":f.scrollMove&&a.preventDefault();break;case"click":f._mask&&($.contains(f._mask[0],a.target)||f._mask[0]===a.target),c=f._wrap.get(0),(b=$(a.target).closest(".ui-dialog-close",c))&&b.length?e.close():(b=$(a.target).closest(".ui-dialog-btns .ui-btn",c))&&b.length&&(d=f.buttons[b.attr("data-key")],d&&d.apply(e,arguments))}},_calculate:function(){var a,b=this,c=b._options,d=document.body,e={},f=c._cIsBody,g=Math.round;c.mask&&(e.mask=f?{width:"100%",height:Math.max(d.scrollHeight,d.clientHeight)}:{width:"100%",height:"100%"});var h=c._wrap.width(),i=c._wrap.height();return a=$(window),e.wrap={left:"50%",marginLeft:-g(h/2)+"px",top:f?g(a.height()/2)+window.pageYOffset:"50%",marginTop:-g(i/2)+"px"},e},refresh:function(){var a,b,c=this,d=c._options;return d._isOpen&&(a=c._calculate(),a.mask&&d._mask.css(a.mask),d._wrap.css(a.wrap),b=function(){a=c._calculate(),a.mask&&d._mask.css(a.mask),d._wrap.css(a.wrap)},$.os.ios&&document.activeElement&&/input|textarea|select/i.test(document.activeElement.tagName)?(document.body.scrollLeft=0,setTimeout(b,200)):b()),c},open:function(a,b){var c=this._options;c._isOpen=!0,c._wrap.css("display","block"),c._mask&&c._mask.css("display","block"),void 0!==a&&this.position?this.position(a,b):this.refresh(),$(document).on("touchmove",$.proxy(this._eventHandler,this))},close:function(){var a,b=this._options;return a=$.Event("beforeClose"),$(this.id).trigger(a),a.defaultPrevented?this:(b._isOpen=!1,b._wrap.css("display","none"),b._mask&&b._mask.css("display","none"),void $(document).off("touchmove",this._eventHandler))},title:function(a){var b=this._options,c=void 0!==a;return c&&(a=(b.title=a)?"<h3>"+a+"</h3>":a,""!=a&&(b._title.html(a),b._title.prependTo(b._wrap)),b._close&&b._close.prependTo(b.title?b._title:b._wrap)),c?this:b.title},content:function(a){var b=this._options,c=void 0!==a;return c&&b._content.empty().append(b.content=a),c?this:b.content},destroy:function(){var a=this._options,b=this._eventHandler;$(window).off("ortchange",b),$(document).off("touchmove",b),a._wrap.off("click",b).remove(),a._mask&&a._mask.off("click",b).remove()}},a}),define("zui/dialog/dialog",["zui/base"],function(a){{var b=a("zui/base"),c=a("zui/dialog/overlay");b.Utils}return{Alert:c.Alert,Confirm:c.Confirm,Flash:c.Flash,Loading:c.Loading,Dialog:c.Dialog}}),define("zui/dialog/mask",["zui/base"],function(a){function b(){}function c(a){var b=a.el.parent().height();b&&"parent"==a.type?a.el.css({"min-height":b}):b=Math.max(e.docHeight(),e.viewportHeight());var c=a.el.parent().width();a.el.css({height:b,width:c,display:"block"})}var d=a("zui/base"),e=d.Utils;return b.prototype={show:function(a,b,d){var e=this;"parent"==b&&(e.type="parent"),d?(e.el=$('<div class="ui-mask dialog-mask">'+e.loading+"</div>"),$(a).append(e.el),c(e)):(e.el=$('<div class="ui-mask dialog-mask"></div>'),$(a).append(e.el),c(e)),$(window).on("onorientationchange"in window?"orientationchange":"resize",function(){c(e)})},close:function(){var a=this;a.el.remove()}},b});